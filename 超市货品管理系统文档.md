# 1. 文档头

- **发起时间：** 2021年1月19日
- **承接人员：** 王淼
- **提交时间：** 2021年1月23日
# 2. 项目介绍

**概念：** Supermarket Management System，超市货品管理系统是一个超市货品的B/S管理系统，能够完成所有超市货品的增删改查的基本操作，以及货品图片的上传和下载功能。

# 3. 项目需求
## 3.1 文档需求

**概念：** 为规范和统一 [承接人员] 的文档格式，[发起人员] 在此指定文档需求，[承接人员] 应严格遵守以下需求：
- 文字前景色一律指定为<span style="color:red;">红色</span>，字体字号保持与本条文本内容一致，加粗视为标题。
- 文字允许使用<mark>黄色背景色</mark>作为标记。
- 不允许私自更改任何文档结构，排版和内容。

## 3.2 环境需求

**概念：** 为规范和统一 [承接人员] 的开发环境，[发起人员] 在此指定环境需求，[承接人员] 应严格遵守以下需求：
- **开发环境：**
    - **操作系统：** windows-all
    - **开发工具：** idea2019+
    - **测试工具：** chrome & postman
- **项目环境：**
    - **项目名：** pro-supermarket-sys
    - **服务器：** tomcat9.0+
- **技术环境：**
    - **视图层：** html5 & css3 & javascript6 & jquery3 & bootstrap3
    - **控制层：** springmvc4+
    - **模型层：** jdk8+/mybatis3+
    - **项目配置：** spring4+
    - **项目管理：** maven3.6+
- **备注信息：**

> 若 [承接人员] 不得不使用其他环境，请在备注信息处加以说明。

## 3.3 数据库需求

**概念：** 为规范和统一 [承接人员] 的数据库环境，[发起人员] 在此指定数据库需求，[承接人员] 应严格遵守以下需求：
- **数据库选型：** mysql
- **数据库版本：** 5.7+
- **可视化工具：** navicat | idea
- **数据库配置：** 
    - **实例**：supermarket?charset=utf8mb4 
    - **账密**：supermarket@localhost/supermarket

### 3.3.1 数据字典

**用户表：user**

字段              | 类型大小      | 注释       | 描述
:---:|:---:|:---:|:---: 
id                | int(11)       | 主键       | PK, Auto inc
username          | varchar(50)   | 账号       | UK, not null
password          | varchar(50)   | 密码       | not null
     
**供货商表：supplier** 

字段              | 类型大小      | 注释       | 描述
:---:|:---:|:---:|:---: 
id                | int(11)       | 主键       | PK, Auto inc
name              | varchar(50)   | 供货商名称 | UK, not null
loc               | varchar(200)  | 供货商地址 | not null

**商品表：goods**

字段              | 类型大小      | 注释       | 描述
:---:|:---:|:---:|:---: 
id                | int(11)       | 主键       | PK, Auto inc
name              | varchar(50)   | 商品名称   | UK, not null
type              | varchar(50)   | 商品类别   | not null
price             | decimal(9,2)  | 商品价格   | not null
unit              | varchar(5)    | 商品单位   | not null
production_date   | date          | 生产日期   | not null
expiry_date       | date          | 过期日期   | not null
supplier_id       | int(11)       | 供货商     | FK(supplier)
information       | varchar(500)  | 描述信息   |

**商品图片表：picture**

字段              | 类型大小      | 注释       | 描述
:---:|:---:|:---:|:---: 
id                | int(11)       | 主键       | PK, Auto inc
src               | varchar(200)  | 图片路径   | not null
title             | varchar(50)   | 图片标题   | 
information       | varchar(500)  | 描述信息   |

**商品图片中间表：goods_picture**

字段              | 类型大小      | 注释       | 描述
:---:|:---:|:---:|:---: 
id                | int(11)       | 主键       | PK, Auto inc
goods_id          | int(11)       | 商品       | FK(goods)
picture_id        | int(11)       | 图片       | FK(picture)

### 3.3.2 测试数据

**用户表测试数据**

id                | username      | password
:---:|:---:|:---:           
1                 | admin         | 123

## 3.4 模块需求

### 3.4.1 登录模块

**概念：** 访问项目直接进入登录界面 `index.html`：

> z-image/登录界面.png

> z-image/登录失败界面.png

> z-image/主界面.png

**页面：** 登录信息框使用 `面板`，居中，上外边距100px，宽度500px：
- `面板头`：内容居中，3号标题。
- `面板体`：文字组合表单控件：
    - `帐号框`：必填，自动焦点，背景提示 `请输入账号...`、测试默认值 `admin`。
    - `密码框`：必填，背景提示 `请输入密码...`，测试默认值 `123`。
    - `alert框`：默认隐藏，内容为 `对不起，您的帐号或密码错误，请重新输入！`。
- `面板脚`：内容居右：`重置按钮` 和 `登录按钮`。

**功能：**
- 点击 `帐号` 或 `密码` 文字时，可以让对应的 `账号框` 或 `密码框` 获得焦点。
- 点击 `重置按钮`：重置 `账号框` 焦点和内容，`密码框` 内容以及 `alert框` 隐藏状态。
- 点击 `提交按钮`：利用AJAX技术进行登录，且必须保证 `帐号框` 和 `密码框` 的 `required` 属性生效：
- 登录失败：在 `alert框` 中提示错误信息，同时将 `帐号框` 和 `密码框` 清空，并让 `账号框` 重新获取焦点。
- 登录成功进入进入系统主界面 `main.html`：
- 主界面part1使用 `巨幕`：
    - 主1号标题内容：`超市货品管理系统`
    - 副2号标题内容：`Supermarket Management System`。
- 主界面part2使用 `栅格`，左2右10：
    - 左侧使用 `垂直导航列表`：文字居中，鼠标经过高亮，选中高亮。
    - 左侧导航 `商品管理` 按钮：在屏幕中远程加载 `goods.html` 页面。
    - 左侧导航 `进货管理` 按钮：在屏幕中远程加载 `进货管理` 页面。
    - 左侧导航 `销售管理` 按钮：在屏幕中远程加载 `销售管理` 页面，暂不开放。
    - 左侧导航 `库存管理` 按钮：在屏幕中远程加载 `库存管理` 页面，暂不开放。
    - 左侧导航 `系统管理` 按钮：在屏幕中远程加载 `系统管理` 页面，暂不开放。
    - 右侧屏幕：内容为 `欢迎你：admin`，动态获取当前登录的帐号名。

### 3.4.2 商品管理界面

> z-image/商品管理界面.png

> z-image/详细信息模态框.png

**页面：** 使用 `面板`：
- `面板头`：当前功能地址提示 `主界面/商品管理`，使用小图标。
- `面板体part1`：功能按钮区，使用 `栅格`，左9右3，整体下外边距10px：
    - 左侧提供 `批量删除` 按钮，左右外边距2px。
    - 右侧提供 `下拉菜单`，可选项为 `每页显示1条`，`每页显示5条` 和 `每页显示10条`。
- `面板体part2`：商品列表区：
    - 首列提供 `全选多选框`。
    - 中间列展示商品数据信息，要求使用响应式表格。
    - 尾列提供 `详细信息`，`修改` 和 `相册` 按钮，左右外边距2px。
- `面板体part3`：数字分页区，内容居中，初始默认显示第1页，每页显示1条。
- `面板脚`：信息提示：`Tips：您可以在本页面对全部商品进行操作！`

**功能：**
- 点击 `全选多选框`：全部选中当前页面的所有数据，再次点击全部取消。
- 点击 `详细信息` 按钮：模态框展示该条商品的详细信息：
    - `模态框头`：内容为：`商品详细信息`，3号标题。
    - `模态框体`：内容为商品对应的商品详细信息，4号标题 + <small>组合。
    - `模态框脚`：确定按钮。 
    - 点击模态框右上角的关闭按钮，可以关闭模态框。
    - 点击模态框确认按钮可以关闭模态框。
- 点击 `相册` 按钮：加载相册管理页面 `goods.html`。
- 点击 `修改` 按钮：加载修改页面。
- 点击 `分页` 元素：首页跳回第一页，尾页跳回最后一页，上一页和下一页完成翻页，数字跳入对应页数页面。
- 改动 `下拉菜单`：无刷新更改每页展示的条目数。

### 3.4.6 相册管理模块

> 相册管理界面.png

> 添加图片模态框.png

**界面：** 使用 `面板`：
- `面板头`：当前功能地址提示 `主界面/相册管理`，使用小图标。
- `面板体`：使用 `栅格` 和 `缩略图` 展示当前商品的所有图片：
    - 主内容包括图片、标题、内容和一个 `删除按钮`，如果商品没有图片，则不显示。
    - 辅内容包括一张图片，也从属于栅格系统中，且位置要放在所有图片之后，图片内容引入一张默认的添加图片 `add.jpg`，见附件，无论商品是否有图片，它都该存在。
- `面板脚`：信息提示：`Tips：您可以在本页面对全部商品图片进行操作！`

**功能：**
- 点击 `删除` 按钮：无刷新删除这张图片：
    - 删除数据库中相关的信息。
    - 删除文件系统中的照片文件。
- 点击 `添加图片` 图片：弹出添加图片的模态框：
    - `模态框头`：内容为："上传图片"，3号标题。
    - `模态框体`：使用栅格，左右比例为7-5
        - 左侧：【文件上传控件】：需要设置如图一致的样式效果，且必填、只读、禁用。
        - 左侧：【文件标题输入框】：必填、限制不能超过8个字。
        - 左侧：【文件信息描述框】：限制不能超过50个字，右下角不可拖拽。
        - 右侧：上传图片的缩略图显示区域。
    - `模态框脚`：居中显示【确认上传按钮】，成功情景。
    - 当点击文件浏览的时候触发文件控件，选中一张图片。
    - 选中图片后，需要判断图片的大小，如果超过10M，给用户提示："文件不能超过10M，请重新选择！"，并阻止后续操作。
    - 选中图片后，需要判断图片的类型，如果不是img和png，给用户提示："文件格式只能是jpg或png，请重新选择！"，并阻止后续操作。
    - 选中图片后，模态框【缩略图区域】会实时显示这张图片。
    - 选中图片后，模态框【文件上传控件】中会实时显示这张图片的真实路径。
    - 点击【确认上传】按钮后，不仅要将相关信息添加到数据库中，还要将这张图片上传到本地"E:\\upload\\picture"文件夹下，如果没有这个文件夹，自己创建一个。
    - 点击【确认上传】按钮后，无刷新为对应商品添加一个照片。
- 点击 `返回`：返回到商品展示页面(goods.html)。

### 3.4.7 修改商品模块

**概念：** 点击【修改】按钮：【屏幕】切换为修改界面（goods_update.html）

> 修改商品.png

**界面描述：**
- 使用【面板】进行布局。
- 【面板头】：当前功能地址提示区，内容为："修改商品"，使用小图标。
- 【面板体】：使用栅格系统（左右比例8-4）布局：
    - 左边【商品名称】：必填，背景提示："请输入商品名称..."，前拼文字"商品名称"。
    - 左边【商品类型】：必填，背景提示："请输入商品类型..."，前拼文字"商品类型"。
    - 左边【商品单价】：必填，只能为数字，背景提示："请输入商品单价..."，前拼文字"商品单价"，后拼文字"元"。
    - 左边【商品单位】：必填，背景提示："请输入商品单位..."，前拼文字"商品单位"。
    - 左边【生产日期】：必填，使用日期控件，背景提示："请输入生产日期..."，前拼文字"生产日期"。
    - 左边【过期日期】：必填，使用日期控件，背景提示："请输入过期日期..."，前拼文字"过期日期"。
    - 左边【供货商家】：必选，背景提示："请选择您的供货商"，前拼文字"供货商家"。
    - 右边【商品备注区】：使用多行文本域，限制行数为12行，背景提示："请输入商品备注..."。
- 【面板脚】：
    - 提供【重置按钮】，危险情景。
    - 提供【提交按钮】，信息情景。

**功能描述：** 点击【提交】按钮：提交修改后的数据，这里不可以直接修改图片信息，如需要修改图片，需要进入【图片】功能中。

### 3.4.8 删除商品模块

**概念：** 点击【批量删除】按钮：完成批量删除，批量删除时需要弹窗提示敏感操作：
- 批量删除弹框确认。
- 批量删除时候，如果用户勾选少于一项，弹框警告。
- 删除成功时，弹窗提示，并转回商品列表页面

### 3.4.9 进货管理

**概念：** 当点击导航中的【进货管理】时，会加载【进货管理页面（purchase.html）】到右侧的【屏幕】：

> 进货管理.png

**界面描述：**
- 使用【面板】进行布局。
- 【面板头】：当前功能地址提示区，内容为："进货管理"，使用小图标。
- 【面板体】：使用栅格系统（左右比例8-4）布局：
    - 左边【商品名称】：必填，背景提示："请输入商品名称..."，前拼文字"商品名称"。
    - 左边【商品类型】：必填，背景提示："请输入商品类型..."，前拼文字"商品类型"。
    - 左边【商品单价】：必填，只能为数字，背景提示："请输入商品单价..."，前拼文字"商品单价"，后拼文字"元"。
    - 左边【商品单位】：必填，背景提示："请输入商品单位..."，前拼文字"商品单位"。
    - 左边【生产日期】：必填，使用日期控件，背景提示："请输入生产日期..."，前拼文字"生产日期"。
    - 左边【过期日期】：必填，使用日期控件，背景提示："请输入过期日期..."，前拼文字"过期日期"。
    - 左边【供货商家】：必选，背景提示："请选择您的供货商"，前拼文字"供货商家"。
    - 右边【商品备注区】：使用多行文本域，限制行数为12行，背景提示："请输入商品备注..."。
- 【面板体】：这是第二块面板体，里面放置两个按钮，一个【添加图片按钮】，一个【删除图片按钮】。
- 【面板脚】：
    - 提供【重置按钮】，危险情景。
    - 提供【提交按钮】，信息情景。

**功能描述：**
- 页面加载时，需要通过ajax查询出所有供货商信息，并且注入到【下拉菜单】中。

### 3.4.10 加号按钮

**概念：** 点击【加号按钮】可以批量展示出【图片上传模块界面】。

> 加号按钮JS效果.png

**界面描述：**
- 整个添加图片的容器模块最外层使用<fieldset>，<legend>内容为："添加图片"。
- 上半部分使用well容器，栅格左右比例7-5
    - 左边【文件上传控件】，禁用，只读，右组合按钮，按钮内容："文件浏览"。
    - 左边【文件标题输入框】，上外边距15px，字数限制8，背景提示字："请填写文件标题..."。
    - 左边【文件描述信息输入框】，7行，上外边距15px，字数限制50，背景提示字："请填写文件描述信息..."
    - 右边上传图片预览区：默认引入defaut.jpg
- 下半部分放置两个区块按钮，一个内容为"+"，一个内容为"-"

**功能描述（续）：**
- 点击【减号按钮】可以删除最后生成的【图片上传模块界面】。
- 点击【提交按钮】，可以完成基本信息 + 备注信息 + 图片的一次性提交，添加后提示添加成功，返回商品列表页面，效果如图：

# 4. 测试

**概念：** 项目完成后，[承接人员] 需要进行项目测试，测试通过后方可提交日报，测试点由 [发起人员] 提出，[承接人员] 需要填写每个测试点的测试结果。
- 如果上传图片大小超过10M，结果正常？ 
    - 测试结果：1
- 如果不通过登录页面直接非法访问main页面，结果正常？
    - 测试结果：2
- 添加业务中，如果添加空格，结果正常？
    - 测试结果：1
- 批量删除是否添加了事物保护？
    - 测试结果：1

> 测试结果填写 `1` 为测试成功，`2` 为测试失败，`3` 为未测试。
